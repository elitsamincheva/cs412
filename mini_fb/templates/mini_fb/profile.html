{% extends 'mini_fb/base.html' %}

{% block content %}
<div class="profile-container">
    <div class="profile-card">
        <!-- Back button to return to the profiles list -->
        <a href="{% url 'show_all_profiles' %}" class="back-button">&larr; Back</a>

        <div class="profile-info">
            <div class="profile-image">
                <!-- Display profile image if available -->
                {% if profile.image_file %}
                <img src="{{ profile.image_file.url }}" alt="Profile Image">
                {% else %}
                <!-- Placeholder text when no profile image is available -->
                <span class="no-image">No Image Available</span>
                {% endif %}
            </div>
            <!-- Display user's name -->
            <h1>{{ profile.first_name }} {{ profile.last_name }}</h1>
            <!-- Display user's city -->
            <p class="city"><strong>City:</strong> {{ profile.city }}</p>
            <!-- Display user's email with a clickable mail link -->
            <p class="email"><strong>Email:</strong> <a href="mailto:{{ profile.email }}">{{ profile.email }}</a></p>
        </div>
    </div>
    
    <!-- button to create a new status message for the profile -->
    <div class="create-status">
        <a href="{% url 'create_status' profile.pk %}" class="create-status-button">Create Status Update</a>
        <a href="{% url 'update_profile' profile.pk %}" class="create-status-button">Update Profile</a>
    </div>

    <!-- section to display the profile's friends -->
    <div class="friends-list">
        <h2>Friends</h2>
        {% if profile.get_friends %}
        <ul>
            {% for friend in profile.get_friends %}
            <li>
                <!-- Link to friend's profile page -->
                <a href="{{ friend.get_absolute_url }}">{{ friend.first_name }} {{ friend.last_name }}</a>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>No friends available.</p>
        {% endif %}
    </div>
    <a href="{% url 'friend_suggestions' profile.id %}">View Friend Suggestions</a>

    <!-- section to display user's status messages -->
    <div class="status-messages">
        <h2>Status Messages</h2>
        {% if profile.get_status_messages %}
        <ul>
            {% for status in profile.get_status_messages %}
            <li>
                <p>{{ status.message }}</p>
                
                <!-- Loop through and display images related to the status -->
                {% with status.get_images as images %}
                    {% if images %}
                        <div class="status-images">
                            {% for img in images %}
                            <img src="{{ img.image_file.url }}" alt="{{ img.caption|default:'Image' }}" width="200">
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}
                <small>Posted on: {{ status.timestamp }}</small>
                <!-- Update and Delete Buttons -->
                <div class="status-actions">
                    <a href="{% url 'update_status' status.pk %}" class="edit-button">Update</a>
                    <a href="{% url 'delete_status' status.pk %}" class="delete-button">Delete</a>
                </div>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>No status messages available.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
